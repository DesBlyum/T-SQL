#  SQL
## Примеры/шаблоны повседневных запросов или просто чего интересного, написанных на T-SQL в базах MS SQL Server 2008 и Sybase ASE 16.1

Запросы целенаправленно "не вылизанные", для демонстрации реального уровня знаний и стиля написания.
Претензий на идеальный, самый оптимальный или самый-самый  не выдвигаю )))

## Не много истории о **Sybase ASE** или в чем различия Sybase и MS SQL?
**Sybase ASE** и **Microsoft SQL Server** изначально имея корни и одинаковую структуру метаданных, прошли долгий путь развития независимо друг от друга. В частности имеют одинаковые названия таблицы, содержащие ключевую информацию об объектах (sysobjects, syscomments и syscolumns). Обе СУБД являются системами управления реляционными базами данных, которые предлагают схожие функциональные возможности, но имеют разные характеристики и возможности.

**Уровни управления параллелизмом и изоляции транзакций:** Microsoft SQL Server поддерживает несколько механизмов управления параллелизмом и предоставляет широкий диапазон уровней изоляции транзакций, включая НЕЗАВЕРШЕННОЕ ЧТЕНИЕ, ЗАФИКСИРОВАННОЕ ЧТЕНИЕ, ПОВТОРЯЕМОЕ ЧТЕНИЕ и СЕРИАЛИЗУЕМОЕ. Sybase, с другой стороны, предлагает ограниченный набор уровней изоляции транзакций, при этом по умолчанию используется значение REPEATABLE READ . SQL Server обеспечивает большую гибкость в управлении параллельными транзакциями и предлагает более высокие уровни изоляции.

**Разбиение на разделы и параллельная обработка:** Microsoft SQL Server предоставляет встроенную поддержку разбиения на разделы больших таблиц и позволяет выполнять параллельные запросы, повышая производительность и масштабируемость в сценариях с большим объемом данных. Однако Sybase не имеет встроенных возможностей разделения и имеет ограниченную поддержку параллельной обработки. SQL Server превосходит Sybase в обработке больших наборов данных и более эффективном выполнении сложных запросов.

**Интеграция с бизнес-аналитикой (BI):** Microsoft SQL Server обеспечивает тесную интеграцию с платформой Microsoft BI, включая такие инструменты, как службы интеграции SQL Server (SSIS), службы анализа SQL Server (SSAS) и службы отчетов SQL Server (SSRS). Эти инструменты обеспечивают бесшовную интеграцию данных, аналитическую обработку и службы отчетов. Хотя Sybase в некоторой степени поддерживает функциональность BI, ей не хватает всеобъемлющей интеграции и богатого набора инструментов, предоставляемых SQL Server.

**Решения для обеспечения доступности и высокой доступности (HA):** Microsoft SQL Server предоставляет различные решения для обеспечения высокой доступности, такие как группы постоянной доступности и экземпляры отказоустойчивого кластера, которые обеспечивают непрерывный доступ к базе данных и минимизируют время простоя. Sybase предлагает аналогичные решения HA, такие как Replication Server и Cluster Edition, но они могут не обеспечивать тот же уровень масштабируемости, простоты использования и гибкости, которые предлагают функции HA SQL Server.

**Инструменты разработки и управления:** Microsoft SQL Server предлагает полный набор инструментов разработки и управления, включая SQL Server Management Studio (SSMS) для администрирования баз данных, Visual Studio для разработки приложений и Azure Data Studio для кроссплатформенного управления базами данных. Sybase предоставляет свои собственные инструменты управления, такие как Sybase Central и SQL Advantage, но они могут не соответствовать обширным возможностям и интеграции, предоставляемым набором инструментов Microsoft.

**Совместимость с платформами и поддержка:** Microsoft SQL Server работает только в операционных системах Windows и обладает отличной поддержкой корпоративных сред на базе Windows. Sybase, с другой стороны, поддерживает платформы Windows и UNIX, AIX, HP-UX, Linux Intel, Sun Solaris что делает его более гибким. В зависимости от конкретных требований платформы может быть отдано предпочтение SQL Server или Sybase на основе их совместимости и возможностей поддержки.

Общие системные таблицы:
1. **sysobjects**  - Используется для хранения информации обо всех объектах в системе (ID, имя объекта, тип объекта и прочие параметры).
Основная таблица для работы с метаданными.
2. **syscomments** - Хранит в себе текст хранимых процедур, пользовательских функций, триггеров и просмотров (views).
3. **syscolumns**  - Хранит в себе информацию о колонках каждой таблицы (имя, тип и пр.).   
4. **sysconstraints** - Хранит в себе информацию о первичных ключах, внешних ключах и подобных им объектах (unique keys, checks, defaults).
5. **sys.sysindexes** (view) или sysindexes (table) - Хранит в себе информацию об индексах.

Общие хранимые процедуры:
6. **sp_columns** - Хранимая процедура выдающая информацию о колонках таблицы по её имени.
7. **sp_helpindex** - Хранимая процедура выдающая информацию об индексах таблицы по её имени.
8. **sp_helpconstraint** - Хранимая процедура выдающая информацию о внешних и первичных ключах таблицы по её имени.

Таблицы и хранимые процедуры, специфические для MSSQL:
1. **sys.sysforeignkeys** - Хранит в себе информацию о внешних ключах.
2. **sp_MShelpcolumns** -  Хранимая процедура которая выдаёт подробную информацию о колонках таблицы по её имени.
3. **sp_MStablekeys** - Хранимая процедура которая выдаёт подробную информацию о первичных и внешних ключах таблицы по её имени.
4. **sp_MStablechecks** - Хранимая процедура которая выдаёт подробную информацию об ограничениях таблицы по её имени.

Microsoft SQL Server (начиная с версии 2005) поддерживает INFORMATION_SCHEMA (этот стандарт также поддерживается MySQL и PostgreSQL).
1. **sys.indexes** - Хранит в себе информацию об индексах и первичных ключах.
2. **sys.triggers** - Хранит в себе информацию о триггерах.
3. **sys.foreign_key_columns** - Хранит в себе информацию о внешних ключах.
4. **information_schema.views** - Хранит в себе информацию о views.
5. **information_schema.routines** - Хранит в себе информацию о хранимых процедурах и функциях.
